<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Padel Match Proposal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
    </style>
</head>
<body class="bg-gray-900 text-white flex items-center justify-center min-h-screen p-4">

    <div class="w-full max-w-2xl mx-auto">
        <main id="proposal-view" class="bg-gray-800 p-8 rounded-2xl shadow-2xl text-center">
            <h1 id="main-title" class="text-3xl font-bold text-emerald-400 mb-2">Padel Match Proposal</h1>
            <p id="sub-title" class="text-gray-400 mb-6">Please select a 2-hour slot below to confirm your match via SMS.</p>
            <div id="slots-container" class="space-y-4">
                <!-- Time slots will be dynamically inserted here -->
            </div>
        </main>
    </div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    
    // --- CONFIGURATION ---
    const scheduleData = {
        myTeam: "The Padel Planners",
        opponentTeam: "Our Opponent",
        myPhoneNumber: "+4521125950",
        matchDurationHours: 2, // The duration of a match in hours
        slotIncrementMinutes: 30, // The interval between possible start times (e.g., 30 for 8:00, 8:30, 9:00)
        // Define available time spans
        proposedTimespans: [
            { date: "2025-08-25", startTime: "08:00", endTime: "14:00" },
            { date: "2025-08-26", startTime: "16:00", endTime: "22:00" },
            { date: "2025-08-27", startTime: "09:00", endTime: "21:00" } // All day availability
        ]
    };

    // --- DOM ELEMENTS ---
    const mainTitle = document.getElementById('main-title');
    const subTitle = document.getElementById('sub-title');
    const slotsContainer = document.getElementById('slots-container');

    // --- FUNCTIONS ---

    // Formats a Date object into a time string like "14:00"
    const formatTime = (date) => {
        return date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit', hour12: false });
    };

    // Formats a date for a heading, e.g., "Monday, August 25, 2025"
    const formatDateHeading = (dateString) => {
        const date = new Date(dateString + "T00:00:00"); // Add time to avoid timezone issues
        const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
        return date.toLocaleDateString(undefined, options);
    };
    
    // Formats a slot for the SMS message, e.g., "Mon, Aug 25 @ 14:00-16:00"
    const formatSlotForSMS = (start, end) => {
        const options = { weekday: 'short', month: 'short', day: 'numeric' };
        const datePart = start.toLocaleDateString(undefined, options);
        return `${datePart} @ ${formatTime(start)}-${formatTime(end)}`;
    };

    // --- INITIALIZATION ---
    
    mainTitle.textContent = `Match Proposal from ${scheduleData.myTeam}`;
    subTitle.textContent = `Hi ${scheduleData.opponentTeam}! Please select a ${scheduleData.matchDurationHours}-hour slot below to confirm our match.`;

    let hasSlots = false;

    // Process each defined timespan
    scheduleData.proposedTimespans.forEach(span => {
        const dayContainer = document.createElement('div');
        const heading = document.createElement('h2');
        heading.className = "text-xl font-semibold text-left text-emerald-300 border-b-2 border-gray-700 pb-2 mb-3";
        heading.textContent = formatDateHeading(span.date);
        dayContainer.appendChild(heading);

        const grid = document.createElement('div');
        grid.className = "grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-2";

        const matchDurationMillis = scheduleData.matchDurationHours * 60 * 60 * 1000;
        const incrementMillis = scheduleData.slotIncrementMinutes * 60 * 1000;

        const startDateTime = new Date(`${span.date}T${span.startTime}`);
        const endDateTime = new Date(`${span.date}T${span.endTime}`);

        let currentStartTime = startDateTime.getTime();

        // Loop through the timespan and generate slots
        while (currentStartTime + matchDurationMillis <= endDateTime.getTime()) {
            hasSlots = true;
            const slotStart = new Date(currentStartTime);
            const slotEnd = new Date(currentStartTime + matchDurationMillis);

            const button = document.createElement('button');
            button.className = 'w-full bg-emerald-600 hover:bg-emerald-700 text-white font-semibold py-3 px-2 rounded-lg transition-colors text-sm';
            button.textContent = `${formatTime(slotStart)} - ${formatTime(slotEnd)}`;
            
            button.onclick = () => {
                const message = `Hey ${scheduleData.myTeam}, this is ${scheduleData.opponentTeam}. We confirm our match for ${formatSlotForSMS(slotStart, slotEnd)}. See you on the court!`;
                window.location.href = `sms:${scheduleData.myPhoneNumber}?body=${encodeURIComponent(message)}`;
            };
            
            grid.appendChild(button);
            currentStartTime += incrementMillis;
        }

        if (grid.hasChildNodes()) {
            dayContainer.appendChild(grid);
            slotsContainer.appendChild(dayContainer);
        }
    });

    if (!hasSlots) {
        slotsContainer.innerHTML = '<p class="text-gray-400">No match times have been proposed yet.</p>';
    }
});
</script>

</body>
</html>
